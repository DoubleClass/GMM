model:
  arch: mini_gpt4
  model_type: pretrain_vicuna0

  max_txt_len: 160
  end_sym: "###"
  prompt_path: "prompts/alignment.txt"
  prompt_template: '###Human: {} ###Assistant: '
  ckpt: '/home/ubuntu/.cache/huggingface/hub/vicuna-7b/prerained_minigpt4_7b.pth'
  # ckpt: '/root/siton-gpfs-caoxusheng/code/mini-CIL/minigpt4/output/tiny_100_5_batch2_epoch1_2_3e6_7_woexp_order2/20231111151/0/checkpoint_0.pth'
  # ckpt: '/root/siton-gpfs-caoxusheng/code/mini-CIL/minigpt4/output/tiny_100_5_batch2_epoch1_2_3e6_7_order3/20231112152/0/checkpoint_0.pth'
  # ckpt: '/root/siton-gpfs-caoxusheng/code/mini-CIL/minigpt4/output/tiny_100_5_batch2_epoch2_3e6_7_order3/20231113143/0/checkpoint_1.pth'
  # ckpt: '/root/siton-gpfs-caoxusheng/code/mini-CIL/minigpt4/output/tiny_100_10_batch2_epoch1_2_3e6_7_order2/20231113142/0/checkpoint_1.pth'
  # ckpt: '/root/siton-gpfs-caoxusheng/code/mini-CIL/minigpt4/output/tiny_100_10_batch2_epoch2_3e7_all_adaptlr/20231107115/0/checkpoint_1.pth'
  # ckpt: '/home/ubuntu/code/new-mini/MiniGPT-4/minigpt4/output/minigpt4_stage2_finetune/20231008163/checkpoint_4.pth' # after b50-6 task 0
  # ckpt: '/home/ubuntu/code/new-mini/MiniGPT-4/minigpt4/output/minigpt4_stage2_finetune/20231008163/checkpoint_4.pth' # task 1
  # ckpt: '/home/ubuntu/code/new-mini/MiniGPT-4/minigpt4/output/minigpt4_stage2_finetune/20231008170/checkpoint_4.pth' # task2
  # ckpt: '/home/ubuntu/code/new-mini/MiniGPT-4/minigpt4/output/minigpt4_stage2_finetune/20231008171/checkpoint_4.pth' # task3
  # ckpt: '/home/ubuntu/code/new-mini/MiniGPT-4/minigpt4/output/minigpt4_stage2_finetune/20231008172/checkpoint_4.pth' # task4

datasets:
  cc_sbu_align:
    vis_processor:
      train:
        name: "blip2_image_train"
        image_size: 224
    text_processor:
      train:
        name: "blip_caption"

run:
  task: image_text_pretrain
  # optimizer
  lr_sched: "linear_warmup_cosine_lr"
  init_lr: 3e-6
  min_lr: 1e-6
  warmup_lr: 1e-7

  weight_decay: 0.05
  max_epoch: 5
  iters_per_epoch: 200
  batch_size_train: 2
  batch_size_eval: 12
  num_workers: 4
  warmup_steps: 200

  seed: 42
  # output_dir: "output/imgr20_20_3e6_batch2_epoch2_order3_2000exp"
  # output_dir: "output/test_img100_10_10_reproduce_epoch5/"
  output_dir: "output/imgr20_20_3e6_batch2_epoch2_order3_2000exp_re/"
  # output_dir: "/root/siton-gpfs-caoxusheng/code/mini-CIL/minigpt4/output/test_cifar100_random_all_3e6_1e6_batch2_epoch3//"

  amp: True
  resume_ckpt_path: null

  evaluate: False 
  train_splits: ["train"]

  device: "cuda"
  world_size: 1
  dist_url: "env://"
  distributed: True

task_num: 10